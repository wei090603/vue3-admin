import{x as e,y as a,z as t,w as l,D as s,n as i,o as r}from"../element-plus/element-plus.fbbbfa29.js";import{G as o,F as n,_ as p}from"../index/index.7b73d109.js";import{c as d,a as m,b as u,d as c}from"../article/article.b354bff6.js";import{d as f,a2 as b,r as g,t as j,b as y,o as h,c as v,X as w,ab as V,ac as x,u as _,a as F,Q as k,H as z,P as D,U as H,F as C,V as M,n as Y}from"../@vue/@vue.0c036a59.js";import"../lodash-es/lodash-es.6278a1be.js";import"../@vueuse/@vueuse.e440a3a6.js";import"../@popperjs/@popperjs.172738d4.js";import"../@ctrl/@ctrl.17547d95.js";import"../dayjs/dayjs.481ce33c.js";import"../axios/axios.d56fff3c.js";import"../async-validator/async-validator.234fb871.js";import"../memoize-one/memoize-one.f0fba034.js";import"../escape-html/escape-html.d572c0fd.js";import"../normalize-wheel-es/normalize-wheel-es.db30398b.js";import"../@floating-ui/@floating-ui.50900a5c.js";import"../../assets/index.755b2133.js";/* empty css                                     */import"../pinia/pinia.46e48237.js";import"../vue-demi/vue-demi.4f3c4c97.js";import"../vue-router/vue-router.fe365eba.js";import"../path-browserify/path-browserify.3d3258d8.js";import"../@element-plus/@element-plus.4f9203c7.js";import"../js-cookie/js-cookie.431252a9.js";import"../nprogress/nprogress.491658f2.js";const T={class:"operate-wrapper"},I={class:"operate-left-btn"},P=M("新增"),N=M("删除"),S={class:"operate-right-btn"},U=M("导入"),O=M("导出"),E=M("保存"),q=M("重置"),A=f({setup(f){const M=b({searchForm:{limit:10,page:1,title:""},formVisible:!1,parentName:""}),A=b({id:"",title:"",parentId:0,grade:0}),B=e=>{$.currentPage=1,M.searchForm=e,G()},G=async()=>{M.searchForm.page=$.currentPage,M.searchForm.limit=$.pageSize;const{list:e,total:a}=await d(M.searchForm);$.data=e,$.total=a},Q=g(),X=()=>{Q.value.resetFields()},J=()=>{X(),A.id="",A.parentId=0,A.grade=0,M.parentName="",M.formVisible=!1},K=e=>{ae.value=!0,Y((()=>{M.parentName=e.title,A.parentId=Number(e.id),A.grade=1}))},L=async()=>{await Q.value.validate(),A.id?await m(A.id,A):await u(A),G(),i({type:"success",message:A.id?"修改成功":"新增成功"}),J()},R=e=>{M.formVisible=!0,Y((()=>{A.id=e.id,A.title=e.title}))},W=({id:e})=>{r.confirm("确定删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await c(e),G(),i({type:"success",message:"删除成功!"})})).catch((()=>{}))},Z=b({onClickSearch:B,onClickClear:B,filters:[{type:o.input,key:"title",label:"分类名：",initialValue:"",validator:[{max:20,message:"请输入 20 个以内字符",trigger:["blur","change"]}]}]}),$=b({currentPage:1,pageSize:10,total:1,data:[],multipleTable:!0,multipleSelection:[],indexes:["序号"],dynamic:!0,hasOperation:!0,pagination:!0,pageHandleFunc:"getTableData",column:[{label:"分类名",prop:"title"},{label:"创建日期",prop:"createdAt",filterParams:["formatTime","YYYY-MM-DD HH:MM:ss"]},{label:"更新日期",prop:"updateAt",filterParams:["formatTime","YYYY-MM-DD HH:MM:ss"]}],operation:{label:"操作",width:"300",data:[{label:"添加子分类",type:"primary",icon:"el-icon-edit",handleFunc:"handleCreate",isShow:e=>0===e.grade},{label:"编辑",type:"primary",icon:"el-icon-edit",handleFunc:"handleEdit"},{label:"删除",type:"danger",icon:"el-icon-delete",handleFunc:"handleDel"}]}}),ee=b({parentId:[{required:!0}],title:[{required:!0,message:"请输入分类名",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}]}),{formVisible:ae,parentName:te}=j(M);return y((()=>{G()})),(i,r)=>{const o=e,d=p,m=a,u=t,c=l;return h(),v(C,null,[w(n,V(x(_(Z))),null,16),F("div",T,[F("div",I,[w(o,{plain:"",onClick:r[0]||(r[0]=e=>ae.value=!0)},{default:k((()=>[P])),_:1}),w(o,{plain:"",type:"danger"},{default:k((()=>[N])),_:1})]),F("div",S,[w(o,{type:"primary"},{default:k((()=>[U])),_:1}),w(o,{type:"primary"},{default:k((()=>[O])),_:1})])]),w(d,{tableOpts:_($),"onUpdate:tableOpts":r[1]||(r[1]=e=>z($)?$.value=e:$=e),onGetTableData:G,onHandleCreate:K,onHandleEdit:R,onHandleDel:W},null,8,["tableOpts"]),w(c,{title:(_(A).id?"编辑":"新增")+"分类",modelValue:_(ae),"onUpdate:modelValue":r[5]||(r[5]=e=>z(ae)?ae.value=e:null),"close-on-click-modal":!1,"close-on-press-escape":!1,width:"40%","before-close":J},{default:k((()=>[w(_(s),{model:_(A),"status-icon":"",rules:_(ee),ref_key:"formEle",ref:Q,"label-width":"100px"},{default:k((()=>[_(A).parentId?(h(),D(u,{key:0,label:"父级分类",prop:"parentId"},{default:k((()=>[w(m,{disabled:"",modelValue:_(te),"onUpdate:modelValue":r[2]||(r[2]=e=>z(te)?te.value=e:null)},null,8,["modelValue"])])),_:1})):H("",!0),w(u,{label:"分类名：",prop:"title"},{default:k((()=>[w(m,{modelValue:_(A).title,"onUpdate:modelValue":r[3]||(r[3]=e=>_(A).title=e)},null,8,["modelValue"])])),_:1}),w(u,null,{default:k((()=>[w(o,{type:"primary",onClick:L},{default:k((()=>[E])),_:1}),w(o,{onClick:r[4]||(r[4]=e=>X())},{default:k((()=>[q])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])],64)}}});export{A as default};
