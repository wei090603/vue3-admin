import{x as e,y as a,z as t,w as l,D as i,n as r,o as s}from"./element-plus-c3f3467b.js";import{G as o,F as d,_ as n}from"./index-6ed81e67.js";import{c as p,a as m,b as c,d as u}from"./article-a417fcf1.js";import{d as f,a2 as b,r as g,t as j,b as y,o as h,c as v,X as V,ab as w,ac as _,u as F,a as x,Q as k,H as D,P as H,U as C,F as M,V as Y,n as T}from"./@vue-722b6523.js";import"./lodash-es-b6050654.js";import"./@vueuse-b2b875ad.js";import"./@popperjs-91a2fff2.js";import"./@ctrl-eb0b847c.js";import"./dayjs-2378ce3f.js";import"./axios-aec7d438.js";import"./async-validator-ec45d329.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-eea50788.js";import"./@floating-ui-a9dc73ab.js";import"./index-1dd190b0.js";/* empty css                      */import"./pinia-f7ddc81d.js";import"./vue-demi-5b9a0fa5.js";import"./vue-router-f341a4d8.js";import"./path-browserify-42f42cef.js";import"./@element-plus-d2a6d80a.js";import"./js-cookie-1db5286e.js";import"./nprogress-2caf32ee.js";const z={class:"operate-wrapper"},I={class:"operate-left-btn"},P=Y("新增"),N=Y("删除"),S={class:"operate-right-btn"},U=Y("导入"),O=Y("导出"),E=Y("保存"),q=Y("重置"),A=f({setup(f){const Y=b({searchForm:{limit:10,page:1,title:""},formVisible:!1,parentName:""}),A=b({id:"",title:"",parentId:0,grade:0}),B=e=>{$.currentPage=1,Y.searchForm=e,G()},G=async()=>{Y.searchForm.page=$.currentPage,Y.searchForm.limit=$.pageSize;const{list:e,total:a}=await p(Y.searchForm);$.data=e,$.total=a},Q=g(),X=()=>{Q.value.resetFields()},J=()=>{X(),A.id="",A.parentId=0,A.grade=0,Y.parentName="",Y.formVisible=!1},K=e=>{ae.value=!0,T((()=>{Y.parentName=e.title,A.parentId=Number(e.id),A.grade=1}))},L=async()=>{await Q.value.validate(),A.id?await m(A.id,A):await c(A),G(),r({type:"success",message:A.id?"修改成功":"新增成功"}),J()},R=e=>{Y.formVisible=!0,T((()=>{A.id=e.id,A.title=e.title}))},W=({id:e})=>{s.confirm("确定删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await u(e),G(),r({type:"success",message:"删除成功!"})})).catch((()=>{}))},Z=b({onClickSearch:B,onClickClear:B,filters:[{type:o.input,key:"title",label:"分类名：",initialValue:"",validator:[{max:20,message:"请输入 20 个以内字符",trigger:["blur","change"]}]}]}),$=b({currentPage:1,pageSize:10,total:1,data:[],multipleTable:!0,multipleSelection:[],indexes:["序号"],dynamic:!0,hasOperation:!0,pagination:!0,pageHandleFunc:"getTableData",column:[{label:"分类名",prop:"title"},{label:"创建日期",prop:"createdAt",filterParams:["formatTime","YYYY-MM-DD HH:MM:ss"]},{label:"更新日期",prop:"updateAt",filterParams:["formatTime","YYYY-MM-DD HH:MM:ss"]}],operation:{label:"操作",width:"300",data:[{label:"添加子分类",type:"primary",icon:"el-icon-edit",handleFunc:"handleCreate",isShow:e=>0===e.grade},{label:"编辑",type:"primary",icon:"el-icon-edit",handleFunc:"handleEdit"},{label:"删除",type:"danger",icon:"el-icon-delete",handleFunc:"handleDel"}]}}),ee=b({parentId:[{required:!0}],title:[{required:!0,message:"请输入分类名",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}]}),{formVisible:ae,parentName:te}=j(Y);return y((()=>{G()})),(r,s)=>{const o=e,p=n,m=a,c=t,u=l;return h(),v(M,null,[V(d,w(_(F(Z))),null,16),x("div",z,[x("div",I,[V(o,{plain:"",onClick:s[0]||(s[0]=e=>ae.value=!0)},{default:k((()=>[P])),_:1}),V(o,{plain:"",type:"danger"},{default:k((()=>[N])),_:1})]),x("div",S,[V(o,{type:"primary"},{default:k((()=>[U])),_:1}),V(o,{type:"primary"},{default:k((()=>[O])),_:1})])]),V(p,{tableOpts:F($),"onUpdate:tableOpts":s[1]||(s[1]=e=>D($)?$.value=e:$=e),onGetTableData:G,onHandleCreate:K,onHandleEdit:R,onHandleDel:W},null,8,["tableOpts"]),V(u,{title:(F(A).id?"编辑":"新增")+"分类",modelValue:F(ae),"onUpdate:modelValue":s[5]||(s[5]=e=>D(ae)?ae.value=e:null),"close-on-click-modal":!1,"close-on-press-escape":!1,width:"40%","before-close":J},{default:k((()=>[V(F(i),{model:F(A),"status-icon":"",rules:F(ee),ref_key:"formEle",ref:Q,"label-width":"100px"},{default:k((()=>[F(A).parentId?(h(),H(c,{key:0,label:"父级分类",prop:"parentId"},{default:k((()=>[V(m,{disabled:"",modelValue:F(te),"onUpdate:modelValue":s[2]||(s[2]=e=>D(te)?te.value=e:null)},null,8,["modelValue"])])),_:1})):C("",!0),V(c,{label:"分类名：",prop:"title"},{default:k((()=>[V(m,{modelValue:F(A).title,"onUpdate:modelValue":s[3]||(s[3]=e=>F(A).title=e)},null,8,["modelValue"])])),_:1}),V(c,null,{default:k((()=>[V(o,{type:"primary",onClick:L},{default:k((()=>[E])),_:1}),V(o,{onClick:s[4]||(s[4]=e=>X())},{default:k((()=>[q])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])],64)}}});export{A as default};
