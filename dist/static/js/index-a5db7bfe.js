var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,a=(e,t)=>{for(var o in t||(t={}))n.call(t,o)&&i(e,o,t[o]);if(r)for(var o of r(t))s.call(t,o)&&i(e,o,t[o]);return e},c=(e,r)=>t(e,o(r));import{Z as l,o as d,c as u,T as p,d as m,x as f,a as h,u as g,G as y,ap as v}from"./@vue-0125bb15.js";import{E as b,a as w,b as _,i as j,l as T}from"./element-plus-9b4bdf92.js";/* empty css                      */import{d as k,c as x}from"./pinia-499f0078.js";import{c as E,a as O}from"./vue-router-d64fcc73.js";import{N as L}from"./nprogress-2caf32ee.js";import{a as P}from"./js-cookie-1db5286e.js";import{a as R}from"./axios-aec7d438.js";import"./lodash-es-b6050654.js";import"./@vueuse-e88faed5.js";import"./@popperjs-91a2fff2.js";import"./@ctrl-eb0b847c.js";import"./dayjs-2378ce3f.js";import"./async-validator-ec45d329.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-eea50788.js";import"./@floating-ui-a9dc73ab.js";import"./vue-demi-5b9a0fa5.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var q=(e,t)=>{const o=e.__vccOpts||e;for(const[r,n]of t)o[r]=n;return o};const z={class:"app"};var I=q({},[["render",function(e,t){const o=l("router-view");return d(),u("div",z,[p(o)])}]]);if("undefined"!=typeof window){let e=function(){var e=document.body,t=document.getElementById("__svg__icons__dom__");t||((t=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",t.style.width="0",t.style.height="0",t.id="__svg__icons__dom__",t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("xmlns:link","http://www.w3.org/1999/xlink")),t.innerHTML='<symbol class="icon" viewBox="0 0 1024 1024"  id="icon-eye-open"><path d="M512 128q69.675 0 135.51 21.163t115.498 54.997 93.483 74.837 73.685 82.006 51.67 74.837 32.17 54.827L1024 512q-2.347 4.992-6.315 13.483T998.87 560.17t-31.658 51.669-44.331 59.99-56.832 64.34-69.504 60.16-82.347 51.5-94.848 34.687T512 896q-69.675 0-135.51-21.163t-115.498-54.826-93.483-74.326-73.685-81.493-51.67-74.496-32.17-54.997L0 513.707q2.347-4.992 6.315-13.483t18.816-34.816 31.658-51.84 44.331-60.33 56.832-64.683 69.504-60.331 82.347-51.84 94.848-34.816T512 128.085zm0 85.333q-46.677 0-91.648 12.331t-81.152 31.83-70.656 47.146-59.648 54.485-48.853 57.686-37.675 52.821-26.325 43.99q12.33 21.674 26.325 43.52t37.675 52.351 48.853 57.003 59.648 53.845T339.2 767.02t81.152 31.488T512 810.667t91.648-12.331 81.152-31.659 70.656-46.848 59.648-54.186 48.853-57.344 37.675-52.651T927.957 512q-12.33-21.675-26.325-43.648t-37.675-52.65-48.853-57.345-59.648-54.186-70.656-46.848-81.152-31.659T512 213.334zm0 128q70.656 0 120.661 50.006T682.667 512 632.66 632.661 512 682.667 391.339 632.66 341.333 512t50.006-120.661T512 341.333zm0 85.334q-35.328 0-60.33 25.002T426.666 512t25.002 60.33T512 597.334t60.33-25.002T597.334 512t-25.002-60.33T512 426.666z" /></symbol><symbol  viewBox="0 0 128 64" id="icon-eye"><path d="M127.072 7.994c1.37-2.208.914-5.152-.914-6.87-2.056-1.717-4.797-1.226-6.396.982-.229.245-25.586 32.382-55.74 32.382-29.24 0-55.74-32.382-55.968-32.627-1.6-1.963-4.57-2.208-6.397-.49C-.17 3.086-.399 6.275 1.2 8.238c.457.736 5.94 7.36 14.62 14.72L4.17 35.96c-1.828 1.963-1.6 5.152.228 6.87.457.98 1.6 1.471 2.742 1.471s2.284-.49 3.198-1.472l12.564-13.983c5.94 4.416 13.021 8.587 20.788 11.53l-4.797 17.418c-.685 2.699.686 5.397 3.198 6.133h1.37c2.057 0 3.884-1.472 4.341-3.68L52.6 42.83c3.655.736 7.538 1.227 11.422 1.227 3.883 0 7.767-.49 11.422-1.227l4.797 17.173c.457 2.208 2.513 3.68 4.34 3.68.457 0 .914 0 1.143-.246 2.513-.736 3.883-3.434 3.198-6.133l-4.797-17.172c7.767-2.944 14.848-7.114 20.788-11.53l12.336 13.738c.913.981 2.056 1.472 3.198 1.472s2.284-.49 3.198-1.472c1.828-1.963 1.828-4.906.228-6.87l-11.65-13.001c9.366-7.36 14.849-14.474 14.849-14.474z" /></symbol><symbol  viewBox="0 0 128 128" id="icon-password"><path d="M108.8 44.322H89.6v-5.36c0-9.04-3.308-24.163-25.6-24.163-23.145 0-25.6 16.881-25.6 24.162v5.361H19.2v-5.36C19.2 15.281 36.798 0 64 0c27.202 0 44.8 15.281 44.8 38.961v5.361zm-32 39.356c0-5.44-5.763-9.832-12.8-9.832-7.037 0-12.8 4.392-12.8 9.832 0 3.682 2.567 6.808 6.407 8.477v11.205c0 2.718 2.875 4.962 6.4 4.962 3.524 0 6.4-2.244 6.4-4.962V92.155c3.833-1.669 6.393-4.795 6.393-8.477zM128 64v49.201c0 8.158-8.645 14.799-19.2 14.799H19.2C8.651 128 0 121.359 0 113.201V64c0-8.153 8.645-14.799 19.2-14.799h89.6c10.555 0 19.2 6.646 19.2 14.799z" /></symbol><symbol  viewBox="0 0 130 130" id="icon-user"><path d="M63.444 64.996c20.633 0 37.359-14.308 37.359-31.953 0-17.649-16.726-31.952-37.359-31.952-20.631 0-37.36 14.303-37.358 31.952 0 17.645 16.727 31.953 37.359 31.953zM80.57 75.65H49.434c-26.652 0-48.26 18.477-48.26 41.27v2.664c0 9.316 21.608 9.325 48.26 9.325H80.57c26.649 0 48.256-.344 48.256-9.325v-2.663c0-22.794-21.605-41.271-48.256-41.271z" stroke="currentColor" /></symbol>',e.insertBefore(t,e.lastChild)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}const A=["xlink:href","fill"],M=m({props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const t=e,o=f((()=>`#icon-${t.name}`)),r=f((()=>t.name?`svg-icon icon-${t.name}`:"svg-icon"));return(t,n)=>(d(),u("svg",{class:y(g(r)),"aria-hidden":"true"},[h("use",{"xlink:href":g(o),fill:e.color},null,8,A)],2))}}),S={},C=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in S)return;S[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((t,o)=>{r.addEventListener("load",t),r.addEventListener("error",(()=>o(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e())):e()},$=[...[{path:"/login",component:()=>C((()=>import("./index-680d447f.js")),["static/js/index-680d447f.js","static/css/index-92d89311.css","static/css/normalize.css-60ce381d.css","static/js/element-plus-9b4bdf92.js","static/css/element-plus-21c3c90c.css","static/js/lodash-es-b6050654.js","static/js/@vue-0125bb15.js","static/js/@vueuse-e88faed5.js","static/js/@popperjs-91a2fff2.js","static/js/@ctrl-eb0b847c.js","static/js/dayjs-2378ce3f.js","static/js/axios-aec7d438.js","static/js/async-validator-ec45d329.js","static/js/memoize-one-99e54574.js","static/js/escape-html-4bbaf1e1.js","static/js/normalize-wheel-es-eea50788.js","static/js/@floating-ui-a9dc73ab.js","static/js/vue-router-d64fcc73.js","static/js/@element-plus-6b8636a9.js","static/js/pinia-499f0078.js","static/js/vue-demi-5b9a0fa5.js","static/js/nprogress-2caf32ee.js","static/css/nprogress-18a10d8a.css","static/js/js-cookie-1db5286e.js"]),meta:{title:"登录",hidden:!0,keepAlive:!1}}]],B=E({history:O(),routes:$});function D(){return P.get("orchid_token")}function V(){return P.remove("orchid_token")}const H=R.CancelToken,N={},U=(e,t=!1)=>{N[e]&&t&&N[e]("取消重复请求"),delete N[e]};let F;const G=R.create({timeout:3e4,baseURL:"https://adminapi.tobtt.cn/",responseType:"json",headers:{"Content-Type":"application/json;charset=UTF-8"}});G.interceptors.request.use((e=>{var t,o;D()&&(e.headers.Authorization="Bearer "+D()||"");const r=e.url+"&"+e.method;return U(r,!0),e.cancelToken=new H((e=>{N[r]=e})),(null==(t=e.$config)?void 0:t.loading)||(F=b.service({lock:!0,text:"玩命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .5)"})),(null==(o=e.$config)?void 0:o.file)&&(e.responseType="blob"),e}),(e=>(null==F||F.close(),Promise.reject(e)))),G.interceptors.response.use((e=>{const t=e.config.url+"&"+e.config.method;U(t);const o=e.data;if(null==F||F.close(),200!==o.code){switch(o.code){case 401:V(),_.confirm("你已被登出，可以取消继续留在该页面，或者重新登录","确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then((()=>{B.replace({path:"/login",query:{redirect:B.currentRoute.value.fullPath}})}));break;case 403:w({message:"对不起，您暂无权限执行该操作",type:"error",duration:5e3});break;default:w({message:o.message,type:"error",duration:5e3})}return Promise.reject(G.interceptors.response)}return o.data}),(e=>(null==F||F.close(),w({message:"内部服务器错误",type:"error",duration:5e3}),Promise.reject(e))));const K=e=>{const t=[];try{e.forEach((e=>{let o={path:null===e.parentId?"/"+e.path:e.path,redirect:""===e.path?"/dashboard":"",name:e.path,component:()=>null===e.parentId?C((()=>import("./index-afc40831.js")),["static/js/index-afc40831.js","static/css/index-3c1611ce.css","static/css/normalize.css-60ce381d.css","static/js/element-plus-9b4bdf92.js","static/css/element-plus-21c3c90c.css","static/js/lodash-es-b6050654.js","static/js/@vue-0125bb15.js","static/js/@vueuse-e88faed5.js","static/js/@popperjs-91a2fff2.js","static/js/@ctrl-eb0b847c.js","static/js/dayjs-2378ce3f.js","static/js/axios-aec7d438.js","static/js/async-validator-ec45d329.js","static/js/memoize-one-99e54574.js","static/js/escape-html-4bbaf1e1.js","static/js/normalize-wheel-es-eea50788.js","static/js/@floating-ui-a9dc73ab.js","static/js/vue-router-d64fcc73.js","static/js/pinia-499f0078.js","static/js/vue-demi-5b9a0fa5.js","static/js/path-browserify-42f42cef.js","static/js/@element-plus-6b8636a9.js","static/js/nprogress-2caf32ee.js","static/css/nprogress-18a10d8a.css","static/js/js-cookie-1db5286e.js"]):function(e){switch(e){case"../pages/dashboard/index.vue":return C((()=>import("./index-2aa56573.js")),["static/js/index-2aa56573.js","static/js/echarts-2a6c9bf9.js","static/js/tslib-ed971494.js","static/js/zrender-a4d5d7e9.js","static/js/@vue-0125bb15.js"]);case"../pages/login/index.vue":return C((()=>import("./index-680d447f.js")),["static/js/index-680d447f.js","static/css/index-92d89311.css","static/css/normalize.css-60ce381d.css","static/js/element-plus-9b4bdf92.js","static/css/element-plus-21c3c90c.css","static/js/lodash-es-b6050654.js","static/js/@vue-0125bb15.js","static/js/@vueuse-e88faed5.js","static/js/@popperjs-91a2fff2.js","static/js/@ctrl-eb0b847c.js","static/js/dayjs-2378ce3f.js","static/js/axios-aec7d438.js","static/js/async-validator-ec45d329.js","static/js/memoize-one-99e54574.js","static/js/escape-html-4bbaf1e1.js","static/js/normalize-wheel-es-eea50788.js","static/js/@floating-ui-a9dc73ab.js","static/js/vue-router-d64fcc73.js","static/js/@element-plus-6b8636a9.js","static/js/pinia-499f0078.js","static/js/vue-demi-5b9a0fa5.js","static/js/nprogress-2caf32ee.js","static/css/nprogress-18a10d8a.css","static/js/js-cookie-1db5286e.js"]);case"../pages/navigation/index.vue":return C((()=>import("./index-fc412720.js")),["static/js/index-fc412720.js","static/css/index-6c1834d5.css","static/css/normalize.css-60ce381d.css","static/js/element-plus-9b4bdf92.js","static/css/element-plus-21c3c90c.css","static/js/lodash-es-b6050654.js","static/js/@vue-0125bb15.js","static/js/@vueuse-e88faed5.js","static/js/@popperjs-91a2fff2.js","static/js/@ctrl-eb0b847c.js","static/js/dayjs-2378ce3f.js","static/js/axios-aec7d438.js","static/js/async-validator-ec45d329.js","static/js/memoize-one-99e54574.js","static/js/escape-html-4bbaf1e1.js","static/js/normalize-wheel-es-eea50788.js","static/js/@floating-ui-a9dc73ab.js","static/js/pinia-499f0078.js","static/js/vue-demi-5b9a0fa5.js","static/js/vue-router-d64fcc73.js","static/js/nprogress-2caf32ee.js","static/css/nprogress-18a10d8a.css","static/js/js-cookie-1db5286e.js"]);default:return new Promise((function(t,o){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+e)))}))}}(`../pages/${e.component}/index.vue`)};if(e.children){const t=K(e.children);o=c(a({},o),{children:t,meta:{title:e.title,hidden:e.status}})}t.push(o)}))}catch(o){return[]}return t},W=k("user",{state:()=>({token:"",roles:[],info:{},routes:[],dynamicRoutes:[],permission:[]}),getters:{showRoutes:e=>e.dynamicRoutes.filter((e=>{var t;return!(null==(t=e.meta)?void 0:t.hidden)}))},actions:{async loginAction(e){const{token:t}=await(o=e,G({url:"/auth/login",method:"post",data:o}));var o;this.token=t,function(e){P.set("orchid_token",e)}(t)},async getInfo(){try{const e=await G({url:"/auth",method:"get"}),{roles:t}=e,o=((e,t)=>{var o={};for(var i in e)n.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&r)for(var i of r(e))t.indexOf(i)<0&&s.call(e,i)&&(o[i]=e[i]);return o})(e,["roles"]);this.info=o,this.roles=t;const i=t.map((e=>e.resources));this.permission=i.reduce(((e,t)=>e.concat(t)))}catch(e){throw new Error(e)}},async generateRoutes(){const e=await(t={},G({url:"manager/resources",method:"get",params:t}));var t;this.dynamicRoutes=K(e),this.dynamicRoutes.push({path:"/:pathMatch(.*)",redirect:"/404",meta:{title:"404",keepAlive:!1,hidden:!0}}),this.dynamicRoutes=$.concat(this.dynamicRoutes)},async loginOut(){await G({url:"/auth/loginOut",method:"get"}),V(),window.localStorage.clear(),location.reload()}}}),Z=["/login"];L.configure({showSpinner:!1}),B.beforeEach((async(e,t,o)=>{var r;if(L.start(),D())if("/login"===e.path)o({path:"/"}),L.done();else{if((null==(r=W().roles)?void 0:r.length)>0)o();else try{await W().getInfo(),await W().generateRoutes();const{dynamicRoutes:t}=W();t.forEach((e=>{B.addRoute(e)})),o(c(a({},e),{replace:!0}))}catch(n){await W().loginOut(),w.error("验证失败,请重新登录"),o({path:"/login"})}L.done()}else Z.includes(e.path)?o():(o(`/login?redirect=${e.path}`),L.done())})),B.afterEach(((e,t)=>{document.title=e.meta.title||"admin后台管理系统",L.done()}));v(I).use(B).use(x()).use(j,{size:"default",zIndex:3e3,locale:T}).component("svg-icon",M).mount("#app");export{q as _,M as a,G as s,W as u};
